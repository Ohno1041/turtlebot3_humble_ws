{
    // コンテナ名を設定
    "name": "ROS 2 TurtleBot3 Dev Container",
    "workspaceFolder": "/workspaces/turtlebot3_humble_ws",
    // コンテナビルドのベースとして、ワークスペースにあるDockerfileを参照
    "build": {
        "dockerfile": "../Dockerfile",
        "context": ".."
    },

    "runArgs": [
        "--network=host",
        "--privileged",
        "--shm-size=1gb",
        "--device=/dev/dri:/dev/dri",
        "--device=/dev/dxg:/dev/dxg",
        // WSLg用のソケットマウント
        "-v", "/tmp/.X11-unix:/tmp/.X11-unix",
        "-v", "/mnt/wslg:/mnt/wslg",
        // WSL2のグラフィックドライバをマウント
        "-v", "/usr/lib/wsl:/usr/lib/wsl",
        // ディスプレイ環境変数を固定
        "-e", "DISPLAY=:0",
        "-e", "WAYLAND_DISPLAY=wayland-0",
        "-e", "XDG_RUNTIME_DIR=/mnt/wslg/runtime-dir",
        "-e", "PULSE_SERVER=/mnt/wslg/PulseServer"
    ],

    "postCreateCommand": "/usr/local/bin/setup_dev_workspace.sh && echo 'Container and workspace setup complete!'",

    "remoteEnv": {
        // Gazeboのキャッシュを隔離し、クリーンな状態で起動させます
        "HOME": "/tmp/clean_home",
        "GAZEBO_FUEL_SERVER": "0.0.0.0",
        "GAZEBO_MODEL_PATH": "/opt/turtlebot3_ws/install/turtlebot3_gazebo/share/turtlebot3_gazebo/models"
    },
    // コンテナ接続後に自動でインストールされるVS Code拡張機能を指定
    // ROS開発に役立つ拡張機能の例です
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-vscode.cpptools",             // C++開発
                "ms-python.python",               // Python開発
                "eamodio.gitlens",                // Git操作の強化
                "dotjoshjohn.vscode-ros"         // ROS開発に役立つ拡張機能を追加
            ]
        }
    }
    
}